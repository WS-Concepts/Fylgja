// Fylgja (https://fylgja.dev)
// Licensed under MIT Open Source

$motion-safe: "prefers-reduced-motion: no-preference";

$radius: 1rem !default;
$padding: 1.5rem !default;
$shadow: 0 3px 5px hsl(0 0% 0% / 18%) !default;

$close-speed: 300ms !default;
$open-speed: 400ms !default;

$backdrop-color: hsl(0 0% 0% / 20%) !default;

:where(dialog, [popover]),
::backdrop {
	@media ($motion-safe) {
		transition-property: translate, opacity, display, overlay;
		transition-duration: var(--speed);
		transition-behavior: allow-discrete;
	}
}

::backdrop {
	background-color: var(--backdrop-color, #{$backdrop-color});
}

:where(dialog, [popover]) {
	--ty: var(--dialog-translate-y, 2rem);
	--tx: var(--dialog-translate-x, 0);
	--speed: var(--dialog-close-speed, #{$close-speed});
	max-block-size: calc(100% - 2em);
	max-inline-size: calc(100% - 2em);
	background-color: var(
		--dialog-bg,
		color-mix(in oklab, var(--root-bg) 90%, white)
	);
	color: var(--dialog-color, var(--root-fg));
	border-radius: $radius;
	padding: $padding;
	box-shadow: var(--dialog-shadow, #{$shadow});
	opacity: 0;
	translate: var(--tx) var(--ty);
}

:where(dialog[open], :popover-open),
:where(dialog[open], :popover-open)::backdrop {
	opacity: 1;

	@starting-style {
		opacity: 0;
	}
}

:where(dialog[open], :popover-open) {
	--speed: var(--dialog-open-speed, #{$open-speed});
	translate: 0 0;

	@starting-style {
		translate: var(--tx) var(--ty);
	}
}

// Add page scroll-lock by default to dialog element modals
:where(:root:has(dialog:is([open]:modal, :popover-open))) {
	overflow: hidden;
}
